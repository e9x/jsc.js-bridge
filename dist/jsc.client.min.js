/*! For license information please see jsc.client.min.js.LICENSE.txt */
var JSC;(()=>{'use strict';var e={'./Bridge.js':(e,t,s)=>{var r=s('./Handle.js');class i{constructor(e){this.host=e,this.ipc=this.host.ipc,this.base_func=Object.setPrototypeOf((function(){}),null),this.base_obj=Object.setPrototypeOf({},null);var t=Object.getOwnPropertyDescriptors(this.base_func);for(let e in t){let s=t[e];s.configurable&&(Object.defineProperty(this.base_func,e,{writable:!0}),delete this.base_func[e])}Object.defineProperty(this.base_func,'toString',{value:()=>'[JSC Function]',writable:!0}),this.proxies=new WeakMap,this.needs_handle=['function','object'],this.symbols=['search','match','matchAll','replace','species','split','toPrimitive','toStringTag','unscopables','asyncIterator','hasInstance','isConcatSpreadable','iterator'],this.ipc.on('eval',((e,t)=>{var s={thrown:!1,data:void 0};try{s.data=eval(t)}catch(e){s.thrown=!0,s.data=e}e(this.ref_create(s))})),this.ipc.on('ref_construct',((e,t,s)=>{var r=[...this.ref_read(s)],i=this.ref_resolve(t);e(this.ref_create(Reflect.construct(i,r)))})),this.ipc.on('ref_apply',((e,t,s,r)=>{var i=this.ref_read(s),o=this.ref_read(r),h=this.ref_resolve(t),n=[];o.length&&(n=[...o]),e(this.ref_create(Reflect.apply(h,i,n)))})),this.ipc.on('ref_has',((e,t,s)=>{e(this.ref_create(Reflect.has(this.ref_resolve(t),this.ref_read(s))))})),this.ipc.on('ref_proto',((e,t)=>{e(this.ref_create(Reflect.getPrototypeOf(this.ref_resolve(t))))})),this.ipc.on('ref_ownkeys',((e,t)=>{e(this.ref_create(Reflect.ownKeys(this.ref_resolve(t))))})),this.ipc.on('ref_desc',((e,t,s)=>{var r=Reflect.getOwnPropertyDescriptor(this.ref_resolve(t),this.ref_read(s));e(r?{writable:r.writable,configurable:r.configurable,enumerable:r.enumerable,value:r.value?'it exists':void 0,get:r.get?this.global.noop:void 0,set:r.set?this.global.noop:void 0}:r)})),this.ipc.on('ref_set',((e,t,s,r)=>{var i=this.ref_read(s),o=this.ref_read(r),h=this.ref_resolve(t);e(this.ref_create(Reflect.set(h,i,o)))})),this.ipc.on('ref_get',((e,t,s)=>{var r=this.ref_read(s),i=this.ref_resolve(t);e(this.ref_create(Reflect.get(i,r)))})),this.refs=new Map,this.ref_create(this),this.global=this.ref_handle(0)}noop(){}ref_delete(e){return this.refs.delete(e)}ref_resolve(e){return this.refs.get(e)}ref_create(e){var t=[typeof e,e,null==e];for(let[s,r]of this.refs)if(e===r)return t[1]=s,t;if(this.proxies.has(e))return t[0]='ref',t[1]=this.proxies.get(e),t;if('symbol'==typeof e){for(let s of this.symbols)if(Symbol[s]==e)return t[0]='symbol_res',t[1]=s,t;console.warn('Could not create symbol:',e)}return this.needs_handle.includes(typeof e)?(t[1]=this.refs.size,this.refs.set(t[1],e),t):t}ref_read([e,t,s]){return s?null:'symbol_res'==e&&'string'==typeof t?Symbol[t]:'ref'==e?this.ref_resolve(t):this.needs_handle.includes(e)?this.ref_handle(t,e):t}ref_handle(e,t='object'){var s=new Proxy('function'==t?this.base_func:this.base_obj,new r(this,e));return this.proxies.set(s,e),s}native_error(e){if(e instanceof JSC.global.Error){return new(e.name in window?window[e.name]:Error)(e.message+e.stack)}return e}}e.exports=i},'./Client.js':(e,t,s)=>{var r=s('./Host.js');e.exports=new class extends r{constructor(){var e=globalThis.jsc_emit;delete globalThis.jsc_emit,super(((...t)=>e(JSON.stringify(t)))),globalThis.global=globalThis,s.g.console_log=console.log=(...e)=>this.ipc.send('log',...e),this.ready.then((()=>{var e=this.global.console;for(let t of Reflect.ownKeys(e))s.g.console[t]=(...s)=>e[t]('[SUB]',...s.map((e=>this.registery.global.native_error(e))))}))}}},'./Events.js':e=>{class t{static resolve_list(e,s){this.listeners||(this.listeners=Symbol());var r=(e[t.listeners]||(e[t.listeners]={}))[s]||(e[t.listeners][s]=[]);return r.merged||(r.merged=!0,e.constructor.hasOwnProperty(t.listeners)&&r.push(...t.resolve_list(e.constructor,s))),r}on(e,s){t.resolve_list(this,e).push(s)}once(e,s){var r=(...t)=>{this.off(e,r),s.call(this,...t)};r[t.original_func]=s,this.on(e,s)}off(e,s){if('function'!=typeof s)throw new Error('callback is not a function');s[t.original_func]&&(s=s[t.original_func]);var r=t.resolve_list(this,e),i=r.indexOf(s);-1!=i&&r.splice(i,1),r.length||delete this[t.listeners][e]}emit(e,...s){var r=t.resolve_list(this,e);if(r.length)for(var i of r)try{i.call(this,...s)}catch(e){this.emit('error',e)}else if(delete this[t.listeners][e],'error'==e)throw s[0]}}e.exports=t},'./Handle.js':e=>{e.exports=class{constructor(e,t){this.host=e,this.id=t}apply(e,t,s){return this.host.ref_read(this.host.ipc.post('ref_apply',this.id,this.host.ref_create(t),s.length?this.host.ref_create(s):['json',[]]))}construct(e,t){return this.host.ref_read(this.host.ipc.post('ref_construct',this.id,this.host.ref_create(t)))}get(e,t){return this.host.ref_read(this.host.ipc.post('ref_get',this.id,this.host.ref_create(t)))}set(e,t,s){return this.host.ref_read(this.host.ipc.post('ref_set',this.id,this.host.ref_create(t),this.host.ref_create(s)))}getOwnPropertyDescriptor(e,t){return this.host.ipc.post('ref_desc',this.id,this.host.ref_create(t))||void 0}getPrototypeOf(e){return this.host.ref_read(this.host.ipc.post('ref_proto',this.id))}has(e,t){return this.host.ipc.post('ref_has',this.id,this.host.ref_create(t))}ownKeys(e){return[...this.host.ref_read(this.host.ipc.post('ref_ownkeys',this.id))]}}},'./Host.js':(e,t,s)=>{var r=s('./Bridge.js'),i=s('./IPC.js');e.exports=class{constructor(e){this.ipc=new i(e);var t={};Object.assign(this.ready=new Promise(((e,s)=>t={resolve:e,reject:s})),t),this.registery=new r(this),this.registery.ref_create(globalThis),this.registery.ref_create(this),this.global=this.registery.ref_handle(1),this.global_jsc=this.registery.ref_handle(2),this.ipc.on('ready',(()=>{this.ready.resolve()}))}debugger(){this.eval('debugger;')}eval(e,...t){var s='function'==typeof e;s&&(e='('+e+')');var r=this.registery.ref_read(this.ipc.post('eval',e));if(r.thrown)throw this.registery.native_error(r.data);return s?r.data(...t):r.data}json(e){return this.global.JSON.parse(JSON.stringify(e))}}},'./IPC.js':(e,t,s)=>{var r=s('./Events.js');e.exports=class extends r{constructor(e){super(),this.send=e,this.on('post',((e,t,...s)=>{this.emit(t,(t=>this.send(e,t)),...s)}))}post(...e){var t,s=Math.random();return this.once(s,(e=>t=e)),this.send('post',s,...e),t}}}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}s.g=function(){if('object'==typeof globalThis)return globalThis;try{return this||new Function('return this')()}catch(e){if('object'==typeof window)return window}}();var r=s('./Client.js');JSC=r})();