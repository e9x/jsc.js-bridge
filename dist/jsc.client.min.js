/*! For license information please see jsc.client.min.js.LICENSE.txt */
var JSC;(()=>{'use strict';var t={'./Client.js':(t,e,s)=>{var r=s('./ClientContext.js');t.exports=new class{constructor(){this.context=new r(this)}}},'./ClientContext.js':(t,e,s)=>{var r=s('./Host.js'),{READY:i}=s('./EventTypes.js');t.exports=class extends r{constructor(t){super({eval:t=>{jscLINK.log(t),this.bridge.eval(t)},id:jscLINK.id,send:(t,...e)=>{this.link.send(t,...e)},delete(){throw new Error('Cannot delete the server context.')},compile_bytecode(){throw new Error('Cannot compile server bytecode.')},eval_bytecode(){throw new Error('Cannot eval server bytecode.')}}),this.link=jscLINK,jscLINK.event=(t,...e)=>{this.ipc.emit(t,...e)||this.link.log('Unregistered event:',t)},this.link.send(69),this.ipc.on(i,(()=>{var t=this.bridge.console;for(let e of['log','error','warn','debug','trace'])globalThis.console[e]='error'==e?(...s)=>{try{t[e]('[SUB]',...s.map((t=>this.native.error(t))))}catch(t){console_log(t+'')}}:t[e].bind(t,'[SUB]')}))}}},'./EventTypes.js':(t,e)=>{e.REF={APPLY:0,CONSTRUCT:1,GET:2,SET:3,GET_DESC:4,SET_DESC:5,GET_PROTO:6,SET_PROTO:7,DELETE_PROP:8,HAS:9,OWNKEYS:10},e.EVAL=11,e.POST=12,e.READY=13},'./Events.js':t=>{class e{static resolve(t,e){var s=this.map.get(t);s||(s=new Map,this.map.set(t,s));var r=s.get(e);return r||(r=new Set,s.set(e,r)),r}on(t,s){if('function'!=typeof s)throw new TypeError('callback is not a function');e.resolve(this,t).add(s)}once(t,s){var r=(...e)=>{this.off(t,r),s.call(this,...e)};r[e.original_func]=s,this.on(t,s)}off(t,s){if('function'!=typeof s)throw new TypeError('callback is not a function');s[e.original_func]&&(s=s[e.original_func]),e.resolve(this,t).delete(s)}emit(t,...s){var r=e.resolve(this,t);if(!r.size){if('error'==t)throw s[0];return!1}for(let t of r)try{t.call(this,...s)}catch(t){this.emit('error',t)}return!0}}e.map=new WeakMap,t.exports=e},'./Host.js':(t,e,s)=>{var r=s('./Refs.js'),i=s('./Events.js'),o=s('./IPC.js'),{EVAL:h}=s('./EventTypes.js');t.exports=class extends i{constructor(t){super(),this.$=t,this.ipc=new o(((t,...e)=>{this.$.send(t,...e)})),this.refs=new r(this),this.refs.create(globalThis),this.refs.create(this),this.bridge=this.refs.handle(1),this.global=this.refs.handle(2),this.native={error:t=>{if(t instanceof this.bridge.Error){new(t.name in globalThis?globalThis[t.name]:Error);return t.name+': '+t.message+'\n'+t.stack}return t}},this.bytecode={compile:t=>{if('function'==typeof t)t=`(${t})()`;else if('string'!=typeof t)throw new TypeError('Context.bytecode.compile only accepts: String, Function');var e=this.$.compile_bytecode(t),s=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2)s[t/2]=parseInt(e.substr(t,2),16);return s},execute:t=>{if(Array.isArray(t))t=new Uint8Array(t);else if(t instanceof ArrayBuffer)t=new Uint8Array(t);else if(!(t instanceof Uint8Array))throw new TypeError('Context.bytecode.execute only accepts: ArrayBuffer, Uint8Array, Array');if(!t.byteLength)throw new Error('Invalid bytecode');var e='';for(let s of t)e+=(255&s).toString(16).toUpperCase().padStart(2,0);this.$.eval_bytecode(e)}}}debugger(){this.eval('debugger;')}execute(t,...e){if('function'!=typeof t){let e=this.refs.read(this.ipc.post(h,t));if(e.thrown)throw this.native.error(e.data);return e.data}{let s=this.refs.read(this.ipc.post(h,'('+t+')'));if(s.thrown)throw this.refs.native.error(s.data);try{return s.data(...e)}catch(t){throw console.log(t),this.refs.native.error(t)}}}json(t){return this.bridge.JSON.parse(JSON.stringify(t))}destroy(){this.$.delete(),delete this.refs,delete this.ipc,delete this.global,delete this.bridge,delete this.native,delete this.bytecode,delete this.$}}},'./IPC.js':(t,e,s)=>{var r=s('./Events.js'),{POST:i}=s('./EventTypes.js');t.exports=class extends r{constructor(t){super(),this.pid=100,this.send=t,this.on(i,((t,e,...s)=>{this.emit(e,(e=>this.send(t--,e)),...s)}))}post(...t){var e,s=this.pid++;return this.once(s,(t=>e=t)),this.send(i,s,...t),e}}},'./Refs.js':(t,e,s)=>{var{REF:r,EVAL:i}=s('./EventTypes.js');class o{constructor(t,e,s){this.host=t,this.id=e,this.base=s}apply(t,e,s){return this.host.read(this.host.ipc.post(r.APPLY,this.id,this.host.create(e),s.length?this.host.create(s):['json',[]]),!0)}construct(t,e,s){return this.host.read(this.host.ipc.post(r.CONSTRUCT,this.id,this.host.create(e),this.host.create(s)),!0)}get(t,e,s){return this.host.read(this.host.ipc.post(r.GET,this.id,this.host.create(e),this.host.create(s)),!0)}set(t,e,s){return this.host.read(this.host.ipc.post(r.SET,this.id,this.host.create(e),this.host.create(s)),!0)}getOwnPropertyDescriptor(t,e){var s=this.host.read(this.host.ipc.post(r.GET_DESC,this.id,this.host.create(e)));return'object'==typeof s?Object.fromEntries(s):s}defineProperty(t,e,s){return this.host.read(this.host.ipc.post(r.SET_DESC,this.id,this.host.create(e),this.host.create(Object.entries(s))))}deleteProperty(t,e){return this.host.read(this.host.ipc.post(r.DELETE_PROP,this.id,this.host.create_ref(),!0))}getPrototypeOf(t){return this.host.read(this.host.ipc.post(r.GET_PROTO,this.id),!0)}setPrototypeOf(t,e){return this.host.read(this.host.ipc.post(r.SET_PROTO,this.id,this.host.create(e)),!0)}has(t,e){return this.host.ipc.post(r.HAS,this.id,this.host.create(e))}ownKeys(t){return[...new Set([...this.host.read(this.host.ipc.post(r.OWNKEYS,this.id),!0)].concat(Reflect.ownKeys(this.base)))]}}class h{name_func(t){var e=Object.getOwnPropertyDescriptors(t);for(let s in e){e[s].configurable&&(Object.defineProperty(t,s,{writable:!0}),delete t[s])}return t}scope(t){return(t,...e)=>{}}constructor(t){this.host=t,this.ipc=this.host.ipc,this.base={function:this.name_func(Object.setPrototypeOf((function(){}),null)),object:Object.setPrototypeOf({},null)},this.proxies=new WeakMap,this.symbols=['search','match','matchAll','replace','species','split','toPrimitive','toStringTag','unscopables','asyncIterator','hasInstance','isConcatSpreadable','iterator'],this.ipc.on(i,((t,e)=>{var s={thrown:!1,data:void 0};try{s.data=eval(e)}catch(t){s.thrown=!0,s.data=t}t(this.create(s))})),this.ipc.on(r.GET,((t,e,s,r)=>{var i,o;e=this.resolve(e),s=this.read(s),r=this.read(r);try{i=Reflect.get(e,s,r)}catch(t){i=t,o=!0}t(this.create(i,o))})),this.ipc.on(r.SET,((t,e,s,r)=>{var i,o;e=this.resolve(e),s=this.read(s),r=this.read(r);try{i=Reflect.set(e,s,r)}catch(t){i=t,o=!0}t(this.create(i,o))})),this.ipc.on(r.APPLY,((t,e,s,r)=>{var i,o;e=this.resolve(e),s=this.read(s),r=(r=this.read(r)).length?[...r]:[];try{i=Reflect.apply(e,s,r)}catch(t){i=t,o=!0}t(this.create(i,o))})),this.ipc.on(r.CONSTRUCT,((t,e,s,r)=>{var i,o;s=[...this.read(s)],r=this.read(r),e=this.resolve(e);try{i=Reflect.construct(e,s,r)}catch(t){i=t,o=!0}t(this.create(i,o))})),this.ipc.on(r.HAS,((t,e,s)=>{var r,i;e=this.resolve(e),s=this.read(s);try{r=Reflect.has(e,s)}catch(t){r=t,i=!0}t(this.create(r,i))})),this.ipc.on(r.GET_PROTO,((t,e)=>{var s,r;try{s=Reflect.getPrototypeOf(this.resolve(e))}catch(t){s=t,r=!0}t(this.create(s,r))})),this.ipc.on(r.SET_PROTO,((t,e,s)=>{var r,i;try{r=Reflect.setPrototypeOf(this.resolve(e),this.read(s))}catch(t){r=t,i=!0}t(this.create(r,i))})),this.ipc.on(r.OWNKEYS,((t,e)=>{var s,r;try{s=Reflect.ownKeys(this.resolve(e))}catch(t){s=t,r=!0}t(this.create(s,r))})),this.ipc.on(r.GET_DESC,((t,e,s)=>{var r,i;e=this.resolve(e),s=this.read(s);try{r=Object.entries(Reflect.getOwnPropertyDescriptor(e,s))}catch(t){r=t,i=!0}t(this.create(r,i))})),this.ipc.on(r.SET_DESC,((t,e,s,r)=>{var i,o;e=this.resolve(e),s=this.read(s),r=this.read(r);try{i=Reflect.defineProperty(e,s,Object.fromEntries(r))}catch(t){i=t,o=!0}t(this.create(i,o))})),this.ipc.on(r.DELETE_PROP,((t,e,s)=>{var r,i;e=this.resolve(e),s=this.read(s);try{r=Reflect.deleteProperty(e,s)}catch(t){r=t,i=!0}t(this.create(r,i))})),this.refs=new Map,this.create(this),this.global=this.handle(0)}delete(t){return this.refs.delete(t)}resolve(t){return this.refs.get(t)}create(t,e=!1){var s=!1,r=[typeof t,t,e];for(let[e,i]of this.refs)t===i&&(r[1]=e,s=!0);if(s);else if(this.proxies.has(t))r[0]='ref',r[1]=this.proxies.get(t);else if('symbol'==typeof t){for(let e of this.symbols)if(Symbol[e]==t){r[0]='symbol_res',r[1]=e;break}}else null===t?(r[0]='json',r[1]=null):this.base[r[0]]&&(r[1]=this.refs.size,this.refs.set(r[1],t));return r}read(t,e){if(!Array.isArray(t))throw new ReferenceError(`The reference cannot be read. Was the reference destroyed? (Recieved '${t}')`);var s,[r,i,o]=t;if(s='undefined'==r?void 0:'symbol_res'==r&&'string'==typeof i?Symbol[i]:'ref'==r?this.resolve(i):this.base[r]?this.handle(i,r):i,o&&e)throw this.host.native.error(s);return s}handle(t,e='object'){var s=this.base[e],r=new Proxy(s,new o(this,t,s));return this.proxies.set(r,t),r}}t.exports=h}},e={};function s(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,s),o.exports}var r=s('./Client.js');JSC=r})();