/*! For license information please see jsc.client.min.js.LICENSE.txt */
var JSC;(()=>{'use strict';var e={'./Client.js':(e,t,r)=>{var s=r('./ClientContext.js');e.exports=new class{constructor(){this.context=new s(this)}}},'./ClientContext.js':(e,t,r)=>{var s=r('./Host.js'),{READY:i}=r('./EventTypes.js');e.exports=class extends s{constructor(e){super({eval:e=>{$.log(e),this.bridge.eval(e)},id:$.id,log:$.log,send:(e,...t)=>JSON.parse($.send(e,...t)),delete(){throw new Error('Cannot delete the server context.')},compile_bytecode(){throw new Error('Cannot compile server bytecode.')},eval_bytecode(){throw new Error('Cannot eval server bytecode.')}}),$.event=this.ipc.emit.bind(this.ipc);for(let e of['log','error','warn','info','debug','trace'])globalThis.console[e]=this.global.emit_log.bind(this.global,e)}}},'./EventTypes.js':(e,t)=>{t.REF={APPLY:0,CONSTRUCT:1,GET:2,SET:3,GET_DESC:4,SET_DESC:5,GET_PROTO:6,SET_PROTO:7,DELETE_PROP:8,HAS:9,OWNKEYS:10},t.EVAL=11,t.READY=12},'./Events.js':e=>{class t{static resolve(e,t){var r=this.map.get(e);r||(r=new Map,this.map.set(e,r));var s=r.get(t);return s||(s=new Set,r.set(t,s)),s}on(e,r){if('function'!=typeof r)throw new TypeError('Callback is not a function.');t.resolve(this,e).add(r)}once(e,r){var s=(...t)=>{this.off(e,s),r.call(this,...t)};s[t.original_func]=r,this.on(e,r)}off(e,r){if('function'!=typeof r)throw new TypeError('Callback is not a function.');r[t.original_func]&&(r=r[t.original_func]),t.resolve(this,e).delete(r)}emit(e,...r){var s=t.resolve(this,e);if(!s.size){if('error'==e)throw r[0];return!1}for(let e of s)try{e.call(this,...r)}catch(e){this.emit('error',e)}return!0}}t.Events=t,t.Router=class{constructor(e=(()=>{})){this.send=e,this.routes=new Map}register(e,t){this.routes.set(e,t)}emit(e,...t){if(!this.routes.has(e))throw new RangeError(`Event ${e} not registered`);return this.routes.get(e).call(this,...t)}emit_gjson(...e){return JSON.stringify(this.emit(...e))}},t.map=new WeakMap,t.mix=e=>{for(let r of['on','once','off','emit'])e[r]=t.prototype[r];return e},e.exports=t},'./Host.js':(e,t,r)=>{var s=r('./Refs.js'),{Events:i,Router:o}=r('./Events.js'),{EVAL:h}=r('./EventTypes.js');e.exports=class extends i{constructor(e){super(),this.$=e,this.ipc=new o(((e,...t)=>this.$.send(e,...t))),this.refs=new s(this),this.refs.create(globalThis),this.refs.create(this),this.bridge=this.refs.handle(1),this.global=this.refs.handle(2),this.native={error:e=>{if(e instanceof this.bridge.Error){new(e.name in globalThis?globalThis[e.name]:Error);return e.name+': '+e.message+'\n'+e.stack}return e}},this.bytecode={compile:e=>{if('function'==typeof e)e=`(${e})()`;else if('string'!=typeof e)throw new TypeError('Context.bytecode.compile only accepts: String, Function');var t=this.$.compile_bytecode(e),r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e/2]=parseInt(t.substr(e,2),16);return r},execute:e=>{if(Array.isArray(e))e=new Uint8Array(e);else if(e instanceof ArrayBuffer)e=new Uint8Array(e);else if(!(e instanceof Uint8Array))throw new TypeError('Context.bytecode.execute only accepts: ArrayBuffer, Uint8Array, Array');if(!e.byteLength)throw new Error('Invalid bytecode');var t='';for(let r of e)t+=(255&r).toString(16).toUpperCase().padStart(2,0);this.$.eval_bytecode(t)}}}execute(e,...t){if('function'!=typeof e){let t=this.refs.read(this.ipc.send(h,e));if(t.thrown)throw this.native.error(t.data);return t.data}{let r=this.refs.read(this.ipc.send(h,'('+e+')'));if(r.thrown)throw this.native.error(r.data);try{return r.data(...t)}catch(e){throw console.log(e),this.native.error(e)}}}json(e){return this.bridge.JSON.parse(JSON.stringify(e))}destroy(){this.$.delete(),delete this.refs,delete this.ipc,delete this.global,delete this.bridge,delete this.native,delete this.bytecode,delete this.$}debugger(){this.execute('debugger;')}}},'./Refs.js':(e,t,r)=>{var{REF:s,EVAL:i}=r('./EventTypes.js');class o{constructor(e,t,r){this.host=e,this.id=t,this.base=r}apply(e,t,r){return this.host.read(this.host.ipc.send(s.APPLY,this.id,this.host.create(t),r.length?this.host.create(r):['json',[]]),!0)}construct(e,t,r){return this.host.read(this.host.ipc.send(s.CONSTRUCT,this.id,this.host.create(t),this.host.create(r)),!0)}get(e,t,r){return this.host.read(this.host.ipc.send(s.GET,this.id,this.host.create(t),this.host.create(r)),!0)}set(e,t,r){return this.host.read(this.host.ipc.send(s.SET,this.id,this.host.create(t),this.host.create(r)),!0)}getOwnPropertyDescriptor(e,t){var r=this.host.read(this.host.ipc.send(s.GET_DESC,this.id,this.host.create(t)));return'object'==typeof r?Object.fromEntries(r):r}defineProperty(e,t,r){return this.host.read(this.host.ipc.send(s.SET_DESC,this.id,this.host.create(t),this.host.create(Object.entries(r))))}deleteProperty(e,t){return this.host.read(this.host.ipc.send(s.DELETE_PROP,this.id,this.host.create_ref(),!0))}getPrototypeOf(e){return this.host.read(this.host.ipc.send(s.GET_PROTO,this.id),!0)}setPrototypeOf(e,t){return this.host.read(this.host.ipc.send(s.SET_PROTO,this.id,this.host.create(t)),!0)}has(e,t){return this.host.ipc.send(s.HAS,this.id,this.host.create(t))}ownKeys(e){return[...new Set([...this.host.read(this.host.ipc.send(s.OWNKEYS,this.id),!0)].concat(Reflect.ownKeys(this.base)))]}}class h{name_func(e){var t=Object.getOwnPropertyDescriptors(e);for(let r in t){t[r].configurable&&(Object.defineProperty(e,r,{writable:!0}),delete e[r])}return e}scope(e){return(e,...t)=>{}}constructor(e){this.host=e,this.ipc=this.host.ipc,this.base={function:this.name_func(Object.setPrototypeOf((function(){}),null)),object:Object.setPrototypeOf({},null)},this.proxies=new WeakMap,this.symbols=['search','match','matchAll','replace','species','split','toPrimitive','toStringTag','unscopables','asyncIterator','hasInstance','isConcatSpreadable','iterator'],this.ipc.register(i,(e=>{var t={thrown:!1,data:void 0};try{t.data=eval(e)}catch(e){t.thrown=!0,t.data=e}return this.create(t)})),this.ipc.register(s.GET,((e,t,r)=>{var s,i;e=this.resolve(e),t=this.read(t),r=this.read(r);try{s=Reflect.get(e,t,r)}catch(e){s=e,i=!0}return this.create(s,i)})),this.ipc.register(s.SET,((e,t,r)=>{var s,i;e=this.resolve(e),t=this.read(t),r=this.read(r);try{s=Reflect.set(e,t,r)}catch(e){s=e,i=!0}return this.create(s,i)})),this.ipc.register(s.APPLY,((e,t,r)=>{var s,i;e=this.resolve(e),t=this.read(t),r=(r=this.read(r)).length?[...r]:[];try{s=Reflect.apply(e,t,r)}catch(e){s=e,i=!0}return this.create(s,i)})),this.ipc.register(s.CONSTRUCT,((e,t,r)=>{var s,i;t=[...this.read(t)],r=this.read(r),e=this.resolve(e);try{s=Reflect.construct(e,t,r)}catch(e){s=e,i=!0}return this.create(s,i)})),this.ipc.register(s.HAS,((e,t)=>{var r,s;e=this.resolve(e),t=this.read(t);try{r=Reflect.has(e,t)}catch(e){r=e,s=!0}return this.create(r,s)})),this.ipc.register(s.GET_PROTO,(e=>{var t,r;try{t=Reflect.getPrototypeOf(this.resolve(e))}catch(e){t=e,r=!0}return this.create(t,r)})),this.ipc.register(s.SET_PROTO,((e,t)=>{var r,s;try{r=Reflect.setPrototypeOf(this.resolve(e),this.read(t))}catch(e){r=e,s=!0}return this.create(r,s)})),this.ipc.register(s.OWNKEYS,(e=>{var t,r;try{t=Reflect.ownKeys(this.resolve(e))}catch(e){t=e,r=!0}return this.create(t,r)})),this.ipc.register(s.GET_DESC,((e,t)=>{var r,s;e=this.resolve(e),t=this.read(t);try{r=Object.entries(Reflect.getOwnPropertyDescriptor(e,t))}catch(e){r=e,s=!0}return this.create(r,s)})),this.ipc.register(s.SET_DESC,((e,t,r)=>{var s,i;e=this.resolve(e),t=this.read(t),r=this.read(r);try{s=Reflect.defineProperty(e,t,Object.fromEntries(r))}catch(e){s=e,i=!0}return this.create(s,i)})),this.ipc.register(s.DELETE_PROP,((e,t)=>{var r,s;e=this.resolve(e),t=this.read(t);try{r=Reflect.deleteProperty(e,t)}catch(e){r=e,s=!0}return this.create(r,s)})),this.refs=new Map,this.create(this),this.global=this.handle(0)}delete(e){return this.refs.delete(e)}resolve(e){return this.refs.get(e)}create(e,t=!1){var r=!1,s=[typeof e,e,t];for(let[t,i]of this.refs)e===i&&(s[1]=t,r=!0);if(r);else if(this.proxies.has(e))s[0]='ref',s[1]=this.proxies.get(e);else if('symbol'==typeof e){for(let t of this.symbols)if(Symbol[t]==e){s[0]='symbol_res',s[1]=t;break}}else null===e?(s[0]='json',s[1]=null):this.base[s[0]]&&(s[1]=this.refs.size,this.refs.set(s[1],e));return s}read(e,t){if(!Array.isArray(e))throw new ReferenceError(`The reference cannot be read. Was the reference destroyed? (Recieved '${e}')`);var r,[s,i,o]=e;if(r='undefined'==s?void 0:'symbol_res'==s&&'string'==typeof i?Symbol[i]:'ref'==s?this.resolve(i):this.base[s]?this.handle(i,s):i,o&&t)throw this.host.native.error(r);return r}handle(e,t='object'){var r=this.base[t],s=new Proxy(r,new o(this,e,r));return this.proxies.set(s,e),s}}e.exports=h}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}var s=r('./Client.js');JSC=s})();